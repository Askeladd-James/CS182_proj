2025-06-08 21:03:07,937 - INFO - 🚀 开始完整的模型比较流程（包括Baseline）...
2025-06-08 21:03:07,938 - INFO - 📁 工作目录: ./data/
2025-06-08 21:03:07,938 - INFO - ✅ 所有必要的数据文件都存在
2025-06-08 21:03:07,939 - INFO - 📂 确保目录存在: data\model
2025-06-08 21:03:07,940 - INFO - 📂 确保目录存在: data\results
2025-06-08 21:03:07,940 - INFO - 📂 确保目录存在: data\analysis_plots
2025-06-08 21:03:07,940 - INFO - 
================================================================================
2025-06-08 21:03:07,940 - INFO - 🔄 阶段1：训练Baseline模型
2025-06-08 21:03:07,940 - INFO - ================================================================================
2025-06-08 21:03:07,941 - INFO - 开始训练Baseline模型...
2025-06-08 21:03:07,944 - ERROR - ❌ Baseline训练过程中出错: cannot import name 'split_data' from 'data_process' (g:\Personal\1C401\CS182_proj\torch_ver\data_process.py)
2025-06-08 21:03:07,945 - ERROR - 错误详情: ImportError
2025-06-08 21:03:07,945 - WARNING - ⚠️  Baseline训练失败，但继续执行其他模型
2025-06-08 21:03:07,945 - INFO - 
================================================================================
2025-06-08 21:03:07,946 - INFO - 🔄 阶段2：训练时间感知模型（包括MMOE）
2025-06-08 21:03:07,946 - INFO - ================================================================================
2025-06-08 21:03:07,946 - INFO - 开始训练时间感知模型...
2025-06-08 21:03:07,959 - ERROR - ❌ 时间感知模型训练过程中出错: cannot import name 'CFModel' from 'model' (g:\Personal\1C401\CS182_proj\torch_ver\model.py)
2025-06-08 21:03:07,960 - ERROR - ❌ 时间感知模型训练失败
2025-06-08 21:03:07,960 - ERROR - ❌ 没有成功训练的模型，跳过分析阶段
2025-06-08 21:03:07,960 - INFO - 
================================================================================
2025-06-08 21:03:07,960 - INFO - 🏁 完整流程执行完成！
2025-06-08 21:03:07,960 - INFO - ================================================================================
2025-06-08 21:03:07,960 - INFO - 
================================================================================
2025-06-08 21:03:07,961 - INFO - 📊 执行进度总结
2025-06-08 21:03:07,961 - INFO - ================================================================================
2025-06-08 21:03:07,961 - INFO - Baseline模型训练: ❌ 失败
2025-06-08 21:03:07,961 - INFO - 时间感知模型训练: ❌ 失败
2025-06-08 21:03:07,961 - INFO - 模型分析和比较: ❌ 失败
2025-06-08 21:03:07,961 - INFO - 
总体进度: 0/3 步骤完成
2025-06-08 21:03:07,962 - INFO - ❌ 所有步骤都失败了，请检查配置和数据
2025-06-08 21:03:07,962 - INFO - 
⏱️  总执行时间: 0.02秒
2025-06-08 21:14:13,417 - INFO - 🚀 开始完整的模型比较流程（包括Baseline）...
2025-06-08 21:14:13,417 - INFO - 📁 工作目录: ./data/
2025-06-08 21:14:13,417 - INFO - ✅ 所有必要的数据文件都存在
2025-06-08 21:14:13,418 - INFO - 📂 确保目录存在: data\model
2025-06-08 21:14:13,418 - INFO - 📂 确保目录存在: data\results
2025-06-08 21:14:13,419 - INFO - 📂 确保目录存在: data\analysis_plots
2025-06-08 21:14:13,419 - INFO - 
================================================================================
2025-06-08 21:14:13,419 - INFO - 🔄 阶段1：训练Baseline模型
2025-06-08 21:14:13,419 - INFO - ================================================================================
2025-06-08 21:14:13,420 - INFO - 开始训练Baseline模型...
2025-06-08 21:14:13,432 - ERROR - ❌ Baseline训练过程中出错: name 'Path' is not defined
2025-06-08 21:14:13,432 - ERROR - 错误详情: NameError
2025-06-08 21:14:13,432 - WARNING - ⚠️  Baseline训练失败，但继续执行其他模型
2025-06-08 21:14:13,433 - INFO - 
================================================================================
2025-06-08 21:14:13,433 - INFO - 🔄 阶段2：训练时间感知模型（包括MMOE）
2025-06-08 21:14:13,433 - INFO - ================================================================================
2025-06-08 21:14:13,434 - INFO - 开始训练时间感知模型...
2025-06-08 21:14:13,439 - ERROR - ❌ 时间感知模型训练过程中出错: cannot import name 'IndependentTimeModel' from 'model' (g:\Personal\1C401\CS182_proj\origin\model.py)
2025-06-08 21:14:13,439 - ERROR - ❌ 时间感知模型训练失败
2025-06-08 21:14:13,440 - ERROR - ❌ 没有成功训练的模型，跳过分析阶段
2025-06-08 21:14:13,440 - INFO - 
================================================================================
2025-06-08 21:14:13,440 - INFO - 🏁 完整流程执行完成！
2025-06-08 21:14:13,440 - INFO - ================================================================================
2025-06-08 21:14:13,441 - INFO - 
================================================================================
2025-06-08 21:14:13,441 - INFO - 📊 执行进度总结
2025-06-08 21:14:13,441 - INFO - ================================================================================
2025-06-08 21:14:13,442 - INFO - Baseline模型训练: ❌ 失败
2025-06-08 21:14:13,442 - INFO - 时间感知模型训练: ❌ 失败
2025-06-08 21:14:13,442 - INFO - 模型分析和比较: ❌ 失败
2025-06-08 21:14:13,442 - INFO - 
总体进度: 0/3 步骤完成
2025-06-08 21:14:13,443 - INFO - ❌ 所有步骤都失败了，请检查配置和数据
2025-06-08 21:14:13,443 - INFO - 
⏱️  总执行时间: 0.02秒
2025-06-08 21:17:52,408 - INFO - 🚀 开始完整的模型比较流程（包括Baseline）...
2025-06-08 21:17:52,416 - INFO - 📁 工作目录: ./data/
2025-06-08 21:17:52,416 - INFO - ✅ 所有必要的数据文件都存在
2025-06-08 21:17:52,417 - INFO - 📂 确保目录存在: data\model
2025-06-08 21:17:52,417 - INFO - 📂 确保目录存在: data\results
2025-06-08 21:17:52,417 - INFO - 📂 确保目录存在: data\analysis_plots
2025-06-08 21:17:52,418 - INFO - 
================================================================================
2025-06-08 21:17:52,418 - INFO - 🔄 阶段1：训练Baseline模型
2025-06-08 21:17:52,418 - INFO - ================================================================================
2025-06-08 21:17:52,418 - INFO - 开始训练Baseline模型...
2025-06-08 21:17:52,516 - INFO - 使用设备: cuda
2025-06-08 21:17:52,516 - INFO - 配置参数: K_FACTORS=60, TIME_FACTORS=16, BATCH_SIZE=512
2025-06-08 21:17:52,517 - INFO - 学习率调度器: ReduceLROnPlateau (初始学习率=0.001)
2025-06-08 21:17:52,517 - INFO - 加载现有数据分割...
2025-06-08 21:17:52,954 - INFO - Loaded existing split data from ./data/split_data
2025-06-08 21:17:52,954 - INFO - 数据分割 - 训练: 805443, 验证: 97383, 测试: 97383
2025-06-08 21:17:53,313 - INFO - 最大用户ID: 6040, 最大电影ID: 3952
2025-06-08 21:17:53,690 - INFO - 选择模型: IndependentTime
2025-06-08 21:17:53,690 - INFO - 模型参数: 总数=628,984, 可训练=628,984
2025-06-08 21:17:55,108 - INFO - 优化器: AdamW (lr=0.001, weight_decay=1e-5)
2025-06-08 21:17:55,109 - INFO - 学习率调度器: ReduceLROnPlateau (factor=0.6, patience=5, min_lr=1e-6)
2025-06-08 21:17:55,109 - INFO - 开始训练...
2025-06-08 21:18:13,144 - INFO - Epoch 1/30
2025-06-08 21:18:13,144 - INFO - Train Loss: 1.6217, Train RMSE: 1.2735
2025-06-08 21:18:13,144 - INFO - Val Loss: 0.8947, Val RMSE: 0.9459
2025-06-08 21:18:13,144 - INFO - Learning rate: 0.001000
2025-06-08 21:18:13,145 - INFO -   → 新的最佳验证损失: 0.8947
2025-06-08 21:18:31,342 - INFO - Epoch 2/30
2025-06-08 21:18:31,342 - INFO - Train Loss: 0.8252, Train RMSE: 0.9084
2025-06-08 21:18:31,342 - INFO - Val Loss: 0.8026, Val RMSE: 0.8959
2025-06-08 21:18:31,342 - INFO - Learning rate: 0.001000
2025-06-08 21:18:31,343 - INFO -   → 新的最佳验证损失: 0.8026
2025-06-08 21:18:49,575 - INFO - Epoch 3/30
2025-06-08 21:18:49,575 - INFO - Train Loss: 0.7628, Train RMSE: 0.8734
2025-06-08 21:18:49,575 - INFO - Val Loss: 0.7713, Val RMSE: 0.8782
2025-06-08 21:18:49,575 - INFO - Learning rate: 0.001000
2025-06-08 21:18:49,575 - INFO -   → 新的最佳验证损失: 0.7713
2025-06-08 21:19:07,528 - INFO - Epoch 4/30
2025-06-08 21:19:07,528 - INFO - Train Loss: 0.7292, Train RMSE: 0.8539
2025-06-08 21:19:07,528 - INFO - Val Loss: 0.7555, Val RMSE: 0.8692
2025-06-08 21:19:07,529 - INFO - Learning rate: 0.001000
2025-06-08 21:19:07,529 - INFO -   → 新的最佳验证损失: 0.7555
2025-06-08 21:19:25,982 - INFO - Epoch 5/30
2025-06-08 21:19:25,982 - INFO - Train Loss: 0.7048, Train RMSE: 0.8395
2025-06-08 21:19:25,983 - INFO - Val Loss: 0.7439, Val RMSE: 0.8625
2025-06-08 21:19:25,983 - INFO - Learning rate: 0.001000
2025-06-08 21:19:25,984 - INFO -   → 新的最佳验证损失: 0.7439
2025-06-08 21:19:44,133 - INFO - Epoch 6/30
2025-06-08 21:19:44,133 - INFO - Train Loss: 0.6852, Train RMSE: 0.8278
2025-06-08 21:19:44,133 - INFO - Val Loss: 0.7370, Val RMSE: 0.8585
2025-06-08 21:19:44,133 - INFO - Learning rate: 0.001000
2025-06-08 21:19:44,134 - INFO -   → 新的最佳验证损失: 0.7370
2025-06-08 21:20:02,224 - INFO - Epoch 7/30
2025-06-08 21:20:02,224 - INFO - Train Loss: 0.6678, Train RMSE: 0.8172
2025-06-08 21:20:02,224 - INFO - Val Loss: 0.7314, Val RMSE: 0.8552
2025-06-08 21:20:02,224 - INFO - Learning rate: 0.001000
2025-06-08 21:20:02,225 - INFO -   → 新的最佳验证损失: 0.7314
2025-06-08 21:20:20,949 - INFO - Epoch 8/30
2025-06-08 21:20:20,949 - INFO - Train Loss: 0.6525, Train RMSE: 0.8078
2025-06-08 21:20:20,950 - INFO - Val Loss: 0.7271, Val RMSE: 0.8527
2025-06-08 21:20:20,950 - INFO - Learning rate: 0.001000
2025-06-08 21:20:20,950 - INFO -   → 新的最佳验证损失: 0.7271
2025-06-08 21:20:39,392 - INFO - Epoch 9/30
2025-06-08 21:20:39,392 - INFO - Train Loss: 0.6390, Train RMSE: 0.7994
2025-06-08 21:20:39,392 - INFO - Val Loss: 0.7251, Val RMSE: 0.8515
2025-06-08 21:20:39,394 - INFO - Learning rate: 0.001000
2025-06-08 21:20:39,394 - INFO -   → 新的最佳验证损失: 0.7251
2025-06-08 21:20:57,282 - INFO - Epoch 10/30
2025-06-08 21:20:57,283 - INFO - Train Loss: 0.6266, Train RMSE: 0.7916
2025-06-08 21:20:57,283 - INFO - Val Loss: 0.7236, Val RMSE: 0.8506
2025-06-08 21:20:57,283 - INFO - Learning rate: 0.001000
2025-06-08 21:20:57,284 - INFO -   → 新的最佳验证损失: 0.7236
2025-06-08 21:21:15,282 - INFO - Epoch 11/30
2025-06-08 21:21:15,283 - INFO - Train Loss: 0.6170, Train RMSE: 0.7855
2025-06-08 21:21:15,283 - INFO - Val Loss: 0.7219, Val RMSE: 0.8497
2025-06-08 21:21:15,284 - INFO - Learning rate: 0.001000
2025-06-08 21:21:15,284 - INFO -   → 新的最佳验证损失: 0.7219
2025-06-08 21:21:33,408 - INFO - Epoch 12/30
2025-06-08 21:21:33,408 - INFO - Train Loss: 0.6071, Train RMSE: 0.7792
2025-06-08 21:21:33,409 - INFO - Val Loss: 0.7221, Val RMSE: 0.8498
2025-06-08 21:21:33,409 - INFO - Learning rate: 0.001000
2025-06-08 21:21:33,409 - INFO -   → 验证损失未改善 (1/10)
2025-06-08 21:21:51,371 - INFO - Epoch 13/30
2025-06-08 21:21:51,373 - INFO - Train Loss: 0.5992, Train RMSE: 0.7741
2025-06-08 21:21:51,373 - INFO - Val Loss: 0.7228, Val RMSE: 0.8501
2025-06-08 21:21:51,373 - INFO - Learning rate: 0.001000
2025-06-08 21:21:51,374 - INFO -   → 验证损失未改善 (2/10)
2025-06-08 21:22:09,397 - INFO - Epoch 14/30
2025-06-08 21:22:09,398 - INFO - Train Loss: 0.5920, Train RMSE: 0.7694
2025-06-08 21:22:09,398 - INFO - Val Loss: 0.7230, Val RMSE: 0.8503
2025-06-08 21:22:09,398 - INFO - Learning rate: 0.001000
2025-06-08 21:22:09,399 - INFO -   → 验证损失未改善 (3/10)
2025-06-08 21:22:27,089 - INFO - Epoch 15/30
2025-06-08 21:22:27,090 - INFO - Train Loss: 0.5862, Train RMSE: 0.7656
2025-06-08 21:22:27,090 - INFO - Val Loss: 0.7242, Val RMSE: 0.8510
2025-06-08 21:22:27,090 - INFO - Learning rate: 0.001000
2025-06-08 21:22:27,091 - INFO -   → 验证损失未改善 (4/10)
2025-06-08 21:22:45,084 - INFO - Epoch 16/30
2025-06-08 21:22:45,084 - INFO - Train Loss: 0.5812, Train RMSE: 0.7623
2025-06-08 21:22:45,085 - INFO - Val Loss: 0.7242, Val RMSE: 0.8510
2025-06-08 21:22:45,085 - INFO - Learning rate: 0.001000
2025-06-08 21:22:45,085 - INFO -   → 验证损失未改善 (5/10)
2025-06-08 21:23:03,021 - INFO - Epoch 17/30
2025-06-08 21:23:03,021 - INFO - Train Loss: 0.5766, Train RMSE: 0.7594
2025-06-08 21:23:03,022 - INFO - Val Loss: 0.7254, Val RMSE: 0.8517
2025-06-08 21:23:03,023 - INFO - Learning rate: 0.000600
2025-06-08 21:23:03,023 - INFO -   → 学习率调整: 0.001000 → 0.000600 (下降 40.0%)
2025-06-08 21:23:03,023 - INFO -   → 验证损失未改善 (6/10)
2025-06-08 21:23:20,961 - INFO - Epoch 18/30
2025-06-08 21:23:20,961 - INFO - Train Loss: 0.5616, Train RMSE: 0.7494
2025-06-08 21:23:20,962 - INFO - Val Loss: 0.7245, Val RMSE: 0.8512
2025-06-08 21:23:20,962 - INFO - Learning rate: 0.000600
2025-06-08 21:23:20,962 - INFO -   → 验证损失未改善 (7/10)
2025-06-08 21:23:38,829 - INFO - Epoch 19/30
2025-06-08 21:23:38,829 - INFO - Train Loss: 0.5589, Train RMSE: 0.7476
2025-06-08 21:23:38,830 - INFO - Val Loss: 0.7247, Val RMSE: 0.8513
2025-06-08 21:23:38,830 - INFO - Learning rate: 0.000600
2025-06-08 21:23:38,830 - INFO -   → 验证损失未改善 (8/10)
2025-06-08 21:23:57,044 - INFO - Epoch 20/30
2025-06-08 21:23:57,046 - INFO - Train Loss: 0.5546, Train RMSE: 0.7447
2025-06-08 21:23:57,046 - INFO - Val Loss: 0.7247, Val RMSE: 0.8513
2025-06-08 21:23:57,046 - INFO - Learning rate: 0.000600
2025-06-08 21:23:57,046 - INFO -   → 验证损失未改善 (9/10)
2025-06-08 21:24:14,933 - INFO - Epoch 21/30
2025-06-08 21:24:14,933 - INFO - Train Loss: 0.5521, Train RMSE: 0.7431
2025-06-08 21:24:14,933 - INFO - Val Loss: 0.7246, Val RMSE: 0.8512
2025-06-08 21:24:14,934 - INFO - Learning rate: 0.000600
2025-06-08 21:24:14,934 - INFO -   → 验证损失未改善 (10/10)
2025-06-08 21:24:14,934 - INFO -   → 早停：验证损失连续 10 轮未改善
2025-06-08 21:24:14,941 - INFO - 训练完成统计:
2025-06-08 21:24:14,941 - INFO -   最佳验证损失: 0.7219
2025-06-08 21:24:14,942 - INFO -   最佳验证RMSE: 0.8497
2025-06-08 21:24:14,943 - INFO -   学习率变化: 0.001000 → 0.000600 (总下降 40.0%)
2025-06-08 21:24:14,943 - INFO -   总训练轮数: 21/30
2025-06-08 21:24:14,963 - INFO - 模型已保存至: ./data/model_checkpoint_IndependentTime_with_scheduler.pt
2025-06-08 21:24:14,965 - INFO - 训练历史已保存至: ./data/model_checkpoint_IndependentTime_with_scheduler_history.json
2025-06-08 21:24:14,966 - INFO - ============================================================
2025-06-08 21:24:14,966 - INFO - 训练完成!
2025-06-08 21:24:14,966 - INFO - 模型: IndependentTime
2025-06-08 21:24:14,966 - INFO - 最佳验证RMSE: 0.8497
2025-06-08 21:24:14,967 - INFO - 学习率变化: 0.001000 → 0.000600
2025-06-08 21:24:14,967 - INFO - 实际训练轮数: 21
2025-06-08 21:24:14,967 - INFO - ============================================================
2025-06-08 21:24:14,973 - ERROR - ❌ Baseline训练过程中出错: not enough values to unpack (expected 3, got 2)
2025-06-08 21:24:14,973 - ERROR - 错误详情: ValueError
2025-06-08 21:24:14,974 - WARNING - ⚠️  Baseline训练失败，但继续执行其他模型
2025-06-08 21:24:14,974 - INFO - 
================================================================================
2025-06-08 21:24:14,974 - INFO - 🔄 阶段2：训练时间感知模型（包括MMOE）
2025-06-08 21:24:14,974 - INFO - ================================================================================
2025-06-08 21:24:14,974 - INFO - 开始训练时间感知模型...
2025-06-08 21:24:14,981 - INFO - 使用设备: cuda
2025-06-08 21:24:14,981 - INFO - 配置参数: {'DEVICE': device(type='cuda'), 'K_FACTORS': 60, 'TIME_FACTORS': 16, 'BATCH_SIZE': 512, 'NUM_EPOCHS': 30, 'LEARNING_RATE': 0.001, 'REG_STRENGTH': 0.001, 'NUM_EXPERTS': 3}
2025-06-08 21:24:14,982 - INFO - 学习率调度器: ReduceLROnPlateau (factor=0.6, patience=5)
2025-06-08 21:24:14,982 - INFO - 加载现有数据分割...
2025-06-08 21:24:15,347 - INFO - Loaded existing split data from ./data/split_data
2025-06-08 21:24:15,347 - INFO - 数据分割 - 训练: 805443, 验证: 97383, 测试: 97383
2025-06-08 21:24:15,350 - INFO - 
============================================================
2025-06-08 21:24:15,351 - INFO - 开始训练和评估Baseline模型: Baseline Collaborative Filtering
2025-06-08 21:24:15,351 - INFO - ============================================================
2025-06-08 21:24:15,361 - INFO - Baseline模型参数: 总数=1,009,193, 可训练=1,009,193
2025-06-08 21:24:15,362 - INFO - 开始训练Baseline模型
2025-06-08 21:24:27,266 - INFO - Epoch 1/30 (11.90s)
2025-06-08 21:24:27,267 - INFO - Train Loss: 3.9060, Train RMSE: 1.9764
2025-06-08 21:24:27,267 - INFO - Val Loss: 0.8760, Val RMSE: 0.9360
2025-06-08 21:24:27,268 - INFO - Learning rate: 0.001000
2025-06-08 21:24:27,268 - INFO - New best validation loss: 0.8760
2025-06-08 21:24:38,671 - INFO - Epoch 2/30 (11.40s)
2025-06-08 21:24:38,672 - INFO - Train Loss: 0.8653, Train RMSE: 0.9302
2025-06-08 21:24:38,672 - INFO - Val Loss: 0.8187, Val RMSE: 0.9048
2025-06-08 21:24:38,673 - INFO - Learning rate: 0.001000
2025-06-08 21:24:38,673 - INFO - New best validation loss: 0.8187
2025-06-08 21:24:50,136 - INFO - Epoch 3/30 (11.46s)
2025-06-08 21:24:50,136 - INFO - Train Loss: 0.8128, Train RMSE: 0.9016
2025-06-08 21:24:50,137 - INFO - Val Loss: 0.7927, Val RMSE: 0.8903
2025-06-08 21:24:50,137 - INFO - Learning rate: 0.001000
2025-06-08 21:24:50,137 - INFO - New best validation loss: 0.7927
2025-06-08 21:25:01,632 - INFO - Epoch 4/30 (11.50s)
2025-06-08 21:25:01,632 - INFO - Train Loss: 0.7741, Train RMSE: 0.8798
2025-06-08 21:25:01,632 - INFO - Val Loss: 0.7731, Val RMSE: 0.8793
2025-06-08 21:25:01,633 - INFO - Learning rate: 0.001000
2025-06-08 21:25:01,633 - INFO - New best validation loss: 0.7731
2025-06-08 21:25:13,063 - INFO - Epoch 5/30 (11.43s)
2025-06-08 21:25:13,063 - INFO - Train Loss: 0.7366, Train RMSE: 0.8582
2025-06-08 21:25:13,063 - INFO - Val Loss: 0.7595, Val RMSE: 0.8715
2025-06-08 21:25:13,063 - INFO - Learning rate: 0.001000
2025-06-08 21:25:13,065 - INFO - New best validation loss: 0.7595
2025-06-08 21:25:24,801 - INFO - Epoch 6/30 (11.74s)
2025-06-08 21:25:24,801 - INFO - Train Loss: 0.6985, Train RMSE: 0.8357
2025-06-08 21:25:24,801 - INFO - Val Loss: 0.7476, Val RMSE: 0.8646
2025-06-08 21:25:24,802 - INFO - Learning rate: 0.001000
2025-06-08 21:25:24,802 - INFO - New best validation loss: 0.7476
2025-06-08 21:25:36,337 - INFO - Epoch 7/30 (11.54s)
2025-06-08 21:25:36,338 - INFO - Train Loss: 0.6593, Train RMSE: 0.8120
2025-06-08 21:25:36,338 - INFO - Val Loss: 0.7412, Val RMSE: 0.8609
2025-06-08 21:25:36,338 - INFO - Learning rate: 0.001000
2025-06-08 21:25:36,339 - INFO - New best validation loss: 0.7412
2025-06-08 21:25:47,650 - INFO - Epoch 8/30 (11.31s)
2025-06-08 21:25:47,650 - INFO - Train Loss: 0.6189, Train RMSE: 0.7867
2025-06-08 21:25:47,650 - INFO - Val Loss: 0.7380, Val RMSE: 0.8590
2025-06-08 21:25:47,651 - INFO - Learning rate: 0.001000
2025-06-08 21:25:47,651 - INFO - New best validation loss: 0.7380
2025-06-08 21:25:59,230 - INFO - Epoch 9/30 (11.58s)
2025-06-08 21:25:59,230 - INFO - Train Loss: 0.5797, Train RMSE: 0.7614
2025-06-08 21:25:59,230 - INFO - Val Loss: 0.7400, Val RMSE: 0.8602
2025-06-08 21:25:59,231 - INFO - Learning rate: 0.001000
2025-06-08 21:26:10,841 - INFO - Epoch 10/30 (11.61s)
2025-06-08 21:26:10,842 - INFO - Train Loss: 0.5435, Train RMSE: 0.7373
2025-06-08 21:26:10,842 - INFO - Val Loss: 0.7426, Val RMSE: 0.8618
2025-06-08 21:26:10,843 - INFO - Learning rate: 0.001000
2025-06-08 21:26:22,912 - INFO - Epoch 11/30 (12.07s)
2025-06-08 21:26:22,912 - INFO - Train Loss: 0.5130, Train RMSE: 0.7162
2025-06-08 21:26:22,913 - INFO - Val Loss: 0.7481, Val RMSE: 0.8650
2025-06-08 21:26:22,913 - INFO - Learning rate: 0.001000
2025-06-08 21:26:34,456 - INFO - Epoch 12/30 (11.54s)
2025-06-08 21:26:34,457 - INFO - Train Loss: 0.4875, Train RMSE: 0.6982
2025-06-08 21:26:34,457 - INFO - Val Loss: 0.7556, Val RMSE: 0.8692
2025-06-08 21:26:34,458 - INFO - Learning rate: 0.001000
2025-06-08 21:26:46,099 - INFO - Epoch 13/30 (11.64s)
2025-06-08 21:26:46,099 - INFO - Train Loss: 0.4671, Train RMSE: 0.6835
2025-06-08 21:26:46,100 - INFO - Val Loss: 0.7629, Val RMSE: 0.8734
2025-06-08 21:26:46,100 - INFO - Learning rate: 0.001000
2025-06-08 21:26:57,995 - INFO - Epoch 14/30 (11.90s)
2025-06-08 21:26:57,995 - INFO - Train Loss: 0.4500, Train RMSE: 0.6708
2025-06-08 21:26:57,996 - INFO - Val Loss: 0.7698, Val RMSE: 0.8774
2025-06-08 21:26:57,996 - INFO - Learning rate: 0.001000
2025-06-08 21:27:09,770 - INFO - Epoch 15/30 (11.77s)
2025-06-08 21:27:09,770 - INFO - Train Loss: 0.4241, Train RMSE: 0.6512
2025-06-08 21:27:09,770 - INFO - Val Loss: 0.7701, Val RMSE: 0.8776
2025-06-08 21:27:09,771 - INFO - Learning rate: 0.000600
2025-06-08 21:27:21,757 - INFO - Epoch 16/30 (11.99s)
2025-06-08 21:27:21,757 - INFO - Train Loss: 0.4140, Train RMSE: 0.6434
2025-06-08 21:27:21,757 - INFO - Val Loss: 0.7732, Val RMSE: 0.8793
2025-06-08 21:27:21,757 - INFO - Learning rate: 0.000600
2025-06-08 21:27:33,521 - INFO - Epoch 17/30 (11.76s)
2025-06-08 21:27:33,521 - INFO - Train Loss: 0.4073, Train RMSE: 0.6382
2025-06-08 21:27:33,521 - INFO - Val Loss: 0.7760, Val RMSE: 0.8809
2025-06-08 21:27:33,522 - INFO - Learning rate: 0.000600
2025-06-08 21:27:45,073 - INFO - Epoch 18/30 (11.55s)
2025-06-08 21:27:45,073 - INFO - Train Loss: 0.4009, Train RMSE: 0.6332
2025-06-08 21:27:45,073 - INFO - Val Loss: 0.7785, Val RMSE: 0.8823
2025-06-08 21:27:45,074 - INFO - Learning rate: 0.000600
2025-06-08 21:27:45,074 - INFO - Early stopping at epoch 18
2025-06-08 21:27:45,074 - INFO - Baseline训练完成！总时间: 209.71s
2025-06-08 21:27:45,074 - INFO - Best validation loss: 0.7380
2025-06-08 21:27:45,074 - INFO - Best validation RMSE: 0.8590
2025-06-08 21:27:45,074 - INFO - 开始评估Baseline模型: Baseline Collaborative Filtering
2025-06-08 21:28:08,927 - INFO - Baseline模型保存至: ./data/model/model_checkpoint_baseline_with_scheduler.pt
2025-06-08 21:28:09,068 - ERROR - 训练Baseline模型时出错: Object of type device is not JSON serializable
2025-06-08 21:28:09,081 - ERROR - 详细错误信息: Traceback (most recent call last):
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 916, in main
    baseline_results = train_and_evaluate_baseline_model(
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 619, in train_and_evaluate_baseline_model
    json.dump(results, f, indent=2, ensure_ascii=False)
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 438, in _iterencode
    o = _default(o)
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type device is not JSON serializable

2025-06-08 21:28:09,083 - INFO - 
============================================================
2025-06-08 21:28:09,083 - INFO - 开始训练和评估模型: 基础协同过滤模型
2025-06-08 21:28:09,084 - INFO - ============================================================
2025-06-08 21:28:09,091 - INFO - 基础协同过滤模型参数: 总数=628,859, 可训练=628,859
2025-06-08 21:28:09,092 - INFO - 开始训练模型: IndependentTime
2025-06-08 21:28:27,600 - INFO - Epoch 1/30 (18.51s)
2025-06-08 21:28:27,600 - INFO - Train Loss: 1.6144, Train RMSE: 1.2706
2025-06-08 21:28:27,600 - INFO - Val Loss: 0.8965, Val RMSE: 0.9469
2025-06-08 21:28:27,600 - INFO - Learning rate: 0.001000
2025-06-08 21:28:27,601 - INFO - New best validation loss: 0.8965
2025-06-08 21:28:45,997 - INFO - Epoch 2/30 (18.40s)
2025-06-08 21:28:45,998 - INFO - Train Loss: 0.8258, Train RMSE: 0.9087
2025-06-08 21:28:45,998 - INFO - Val Loss: 0.8016, Val RMSE: 0.8953
2025-06-08 21:28:45,998 - INFO - Learning rate: 0.001000
2025-06-08 21:28:45,998 - INFO - New best validation loss: 0.8016
2025-06-08 21:37:23,442 - INFO - 🚀 开始完整的模型比较流程...
2025-06-08 21:37:23,442 - INFO - 📁 工作目录: ./data/
2025-06-08 21:37:23,443 - INFO - ✅ 所有必要的数据文件都存在
2025-06-08 21:37:23,444 - INFO - 📂 确保目录存在: data\model
2025-06-08 21:37:23,444 - INFO - 📂 确保目录存在: data\results
2025-06-08 21:37:23,445 - INFO - 📂 确保目录存在: data\analysis_plots
2025-06-08 21:37:23,446 - INFO - 
================================================================================
2025-06-08 21:37:23,446 - INFO - 🔄 阶段1：训练所有模型
2025-06-08 21:37:23,446 - INFO - ================================================================================
2025-06-08 21:37:23,446 - INFO - 包括：Baseline、时间感知模型（UserTime、IndependentTime、UMTime）、MMOE
2025-06-08 21:37:23,446 - INFO - 开始训练所有模型...
2025-06-08 21:37:23,486 - INFO - 使用设备: cuda
2025-06-08 21:37:23,486 - INFO - 配置参数: {'DEVICE': device(type='cuda'), 'K_FACTORS': 60, 'TIME_FACTORS': 20, 'BATCH_SIZE': 256, 'NUM_EPOCHS_PER_STAGE': [1, 1, 1], 'LEARNING_RATES': [0.001, 0.001, 0.001], 'REG_STRENGTH': 0.001, 'NUM_EXPERTS': 4}
2025-06-08 21:37:23,487 - INFO - 学习率调度器: ReduceLROnPlateau (factor=0.6, patience=5)
2025-06-08 21:37:23,489 - INFO - 加载现有数据分割...
2025-06-08 21:37:23,959 - INFO - Loaded existing split data from ./data/split_data
2025-06-08 21:37:23,959 - INFO - 数据分割 - 训练: 805443, 验证: 97383, 测试: 97383
2025-06-08 21:37:23,964 - INFO - 
============================================================
2025-06-08 21:37:23,965 - INFO - 开始训练和评估Baseline模型: Baseline Collaborative Filtering
2025-06-08 21:37:23,965 - INFO - ============================================================
2025-06-08 21:37:24,291 - INFO - Baseline模型参数: 总数=1,009,193, 可训练=1,009,193
2025-06-08 21:37:24,291 - ERROR - 训练Baseline模型时出错: 'LEARNING_RATE'
2025-06-08 21:37:24,292 - ERROR - 详细错误信息: Traceback (most recent call last):
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 916, in main
    baseline_results = train_and_evaluate_baseline_model(
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 568, in train_and_evaluate_baseline_model
    optimizer = optim.Adam(model.parameters(), lr=config['LEARNING_RATE'], weight_decay=1e-6)
KeyError: 'LEARNING_RATE'

2025-06-08 21:37:24,292 - INFO - 
============================================================
2025-06-08 21:37:24,292 - INFO - 开始训练和评估模型: 基础协同过滤模型
2025-06-08 21:37:24,292 - INFO - ============================================================
2025-06-08 21:37:24,299 - INFO - 基础协同过滤模型参数: 总数=629,399, 可训练=629,399
2025-06-08 21:37:24,300 - ERROR - 训练模型 基础协同过滤模型 时出错: 'LEARNING_RATE'
2025-06-08 21:37:24,300 - ERROR - 详细错误信息: Traceback (most recent call last):
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 929, in main
    results = train_and_evaluate_model(
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 241, in train_and_evaluate_model
    optimizer = optim.Adam(model.parameters(), lr=config['LEARNING_RATE'], weight_decay=1e-6)
KeyError: 'LEARNING_RATE'

2025-06-08 21:37:24,300 - INFO - 
============================================================
2025-06-08 21:37:24,301 - INFO - 开始训练和评估模型: 简化时间感知模型
2025-06-08 21:37:24,301 - INFO - ============================================================
2025-06-08 21:37:24,307 - INFO - 简化时间感知模型参数: 总数=611,259, 可训练=611,259
2025-06-08 21:37:24,308 - ERROR - 训练模型 简化时间感知模型 时出错: 'LEARNING_RATE'
2025-06-08 21:37:24,308 - ERROR - 详细错误信息: Traceback (most recent call last):
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 929, in main
    results = train_and_evaluate_model(
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 241, in train_and_evaluate_model
    optimizer = optim.Adam(model.parameters(), lr=config['LEARNING_RATE'], weight_decay=1e-6)
KeyError: 'LEARNING_RATE'

2025-06-08 21:37:24,309 - INFO - 
============================================================
2025-06-08 21:37:24,309 - INFO - 开始训练和评估模型: 复杂时间感知模型
2025-06-08 21:37:24,309 - INFO - ============================================================
2025-06-08 21:37:24,317 - INFO - 复杂时间感知模型参数: 总数=615,849, 可训练=615,849
2025-06-08 21:37:24,317 - ERROR - 训练模型 复杂时间感知模型 时出错: 'LEARNING_RATE'
2025-06-08 21:37:24,319 - ERROR - 详细错误信息: Traceback (most recent call last):
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 929, in main
    results = train_and_evaluate_model(
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 241, in train_and_evaluate_model
    optimizer = optim.Adam(model.parameters(), lr=config['LEARNING_RATE'], weight_decay=1e-6)
KeyError: 'LEARNING_RATE'

2025-06-08 21:37:24,319 - INFO - 
============================================================
2025-06-08 21:37:24,319 - INFO - 开始训练和评估MMOE模型: 两阶段MMoE模型(带学习率调度)
2025-06-08 21:37:24,319 - INFO - ============================================================
2025-06-08 21:37:24,327 - INFO - MMOE模型参数: 总数=665,641, 可训练=665,641
2025-06-08 21:46:09,083 - INFO - 🚀 开始完整的模型比较流程...
2025-06-08 21:46:09,083 - INFO - 📁 工作目录: ./data/
2025-06-08 21:46:09,083 - INFO - ✅ 所有必要的数据文件都存在
2025-06-08 21:46:09,084 - INFO - 📂 确保目录存在: data\model
2025-06-08 21:46:09,084 - INFO - 📂 确保目录存在: data\results
2025-06-08 21:46:09,084 - INFO - 📂 确保目录存在: data\analysis_plots
2025-06-08 21:46:09,084 - INFO - 
================================================================================
2025-06-08 21:46:09,084 - INFO - 🔄 阶段1：训练所有模型
2025-06-08 21:46:09,084 - INFO - ================================================================================
2025-06-08 21:46:09,084 - INFO - 包括：Baseline、时间感知模型（UserTime、IndependentTime、UMTime）、MMOE
2025-06-08 21:46:09,084 - INFO - 开始训练所有模型...
2025-06-08 21:46:09,115 - INFO - 使用设备: cuda
2025-06-08 21:46:09,115 - INFO - 配置参数: {'DEVICE': device(type='cuda'), 'K_FACTORS': 100, 'TIME_FACTORS': 40, 'BATCH_SIZE': 256, 'NUM_EPOCHS': 30, 'LEARNING_RATE': 0.001, 'REG_STRENGTH': 0.001, 'NUM_EXPERTS': 4, 'NUM_EPOCHS_PER_STAGE': [30, 30, 30], 'LEARNING_RATES': [0.001, 0.001, 0.0005]}
2025-06-08 21:46:09,116 - INFO - 学习率调度器: ReduceLROnPlateau (factor=0.6, patience=5)
2025-06-08 21:46:09,116 - INFO - 加载现有数据分割...
2025-06-08 21:46:09,497 - INFO - Loaded existing split data from ./data/split_data
2025-06-08 21:46:09,497 - INFO - 数据分割 - 训练: 805443, 验证: 97383, 测试: 97383
2025-06-08 21:46:09,503 - INFO - 
============================================================
2025-06-08 21:46:09,504 - INFO - 开始训练和评估Baseline模型: Baseline Collaborative Filtering
2025-06-08 21:46:09,504 - INFO - ============================================================
2025-06-08 21:46:09,897 - INFO - Baseline模型参数: 总数=1,009,193, 可训练=1,009,193
2025-06-08 21:46:11,006 - INFO - 开始训练Baseline模型
2025-06-08 21:46:23,564 - INFO - Epoch 1/30 (12.56s)
2025-06-08 21:46:23,565 - INFO - Train Loss: 2.8770, Train RMSE: 1.6962
2025-06-08 21:46:23,565 - INFO - Val Loss: 0.8515, Val RMSE: 0.9228
2025-06-08 21:46:23,565 - INFO - Learning rate: 0.001000
2025-06-08 21:46:23,565 - INFO - New best validation loss: 0.8515
2025-06-08 21:46:36,397 - INFO - Epoch 2/30 (12.83s)
2025-06-08 21:46:36,397 - INFO - Train Loss: 0.8301, Train RMSE: 0.9111
2025-06-08 21:46:36,398 - INFO - Val Loss: 0.7991, Val RMSE: 0.8939
2025-06-08 21:46:36,398 - INFO - Learning rate: 0.001000
2025-06-08 21:46:36,398 - INFO - New best validation loss: 0.7991
2025-06-08 21:46:49,443 - INFO - Epoch 3/30 (13.04s)
2025-06-08 21:46:49,443 - INFO - Train Loss: 0.7693, Train RMSE: 0.8771
2025-06-08 21:46:49,443 - INFO - Val Loss: 0.7727, Val RMSE: 0.8790
2025-06-08 21:46:49,444 - INFO - Learning rate: 0.001000
2025-06-08 21:46:49,444 - INFO - New best validation loss: 0.7727
2025-06-08 21:47:02,560 - INFO - Epoch 4/30 (13.12s)
2025-06-08 21:47:02,560 - INFO - Train Loss: 0.7132, Train RMSE: 0.8445
2025-06-08 21:47:02,560 - INFO - Val Loss: 0.7554, Val RMSE: 0.8691
2025-06-08 21:47:02,560 - INFO - Learning rate: 0.001000
2025-06-08 21:47:02,561 - INFO - New best validation loss: 0.7554
2025-06-08 21:47:15,425 - INFO - Epoch 5/30 (12.86s)
2025-06-08 21:47:15,426 - INFO - Train Loss: 0.6579, Train RMSE: 0.8111
2025-06-08 21:47:15,426 - INFO - Val Loss: 0.7457, Val RMSE: 0.8635
2025-06-08 21:47:15,426 - INFO - Learning rate: 0.001000
2025-06-08 21:47:15,426 - INFO - New best validation loss: 0.7457
2025-06-08 21:47:28,389 - INFO - Epoch 6/30 (12.96s)
2025-06-08 21:47:28,389 - INFO - Train Loss: 0.6047, Train RMSE: 0.7776
2025-06-08 21:47:28,391 - INFO - Val Loss: 0.7448, Val RMSE: 0.8630
2025-06-08 21:47:28,391 - INFO - Learning rate: 0.001000
2025-06-08 21:47:28,391 - INFO - New best validation loss: 0.7448
2025-06-08 21:47:41,176 - INFO - Epoch 7/30 (12.78s)
2025-06-08 21:47:41,177 - INFO - Train Loss: 0.5580, Train RMSE: 0.7470
2025-06-08 21:47:41,177 - INFO - Val Loss: 0.7505, Val RMSE: 0.8663
2025-06-08 21:47:41,177 - INFO - Learning rate: 0.001000
2025-06-08 21:47:54,149 - INFO - Epoch 8/30 (12.97s)
2025-06-08 21:47:54,149 - INFO - Train Loss: 0.5186, Train RMSE: 0.7201
2025-06-08 21:47:54,150 - INFO - Val Loss: 0.7598, Val RMSE: 0.8717
2025-06-08 21:47:54,150 - INFO - Learning rate: 0.001000
2025-06-08 21:48:07,221 - INFO - Epoch 9/30 (13.07s)
2025-06-08 21:48:07,222 - INFO - Train Loss: 0.4904, Train RMSE: 0.7003
2025-06-08 21:48:07,222 - INFO - Val Loss: 0.7692, Val RMSE: 0.8770
2025-06-08 21:48:07,222 - INFO - Learning rate: 0.001000
2025-06-08 21:48:19,919 - INFO - Epoch 10/30 (12.70s)
2025-06-08 21:48:19,919 - INFO - Train Loss: 0.4670, Train RMSE: 0.6834
2025-06-08 21:48:19,919 - INFO - Val Loss: 0.7777, Val RMSE: 0.8819
2025-06-08 21:48:19,919 - INFO - Learning rate: 0.001000
2025-06-08 21:48:32,725 - INFO - Epoch 11/30 (12.80s)
2025-06-08 21:48:32,726 - INFO - Train Loss: 0.4493, Train RMSE: 0.6703
2025-06-08 21:48:32,726 - INFO - Val Loss: 0.7855, Val RMSE: 0.8863
2025-06-08 21:48:32,726 - INFO - Learning rate: 0.001000
2025-06-08 21:48:45,770 - INFO - Epoch 12/30 (13.04s)
2025-06-08 21:48:45,771 - INFO - Train Loss: 0.4368, Train RMSE: 0.6609
2025-06-08 21:48:45,771 - INFO - Val Loss: 0.7912, Val RMSE: 0.8895
2025-06-08 21:48:45,772 - INFO - Learning rate: 0.001000
2025-06-08 21:48:58,728 - INFO - Epoch 13/30 (12.96s)
2025-06-08 21:48:58,728 - INFO - Train Loss: 0.4091, Train RMSE: 0.6396
2025-06-08 21:48:58,728 - INFO - Val Loss: 0.7911, Val RMSE: 0.8894
2025-06-08 21:48:58,729 - INFO - Learning rate: 0.000600
2025-06-08 21:49:11,255 - INFO - Epoch 14/30 (12.53s)
2025-06-08 21:49:11,255 - INFO - Train Loss: 0.3995, Train RMSE: 0.6320
2025-06-08 21:49:11,255 - INFO - Val Loss: 0.7930, Val RMSE: 0.8905
2025-06-08 21:49:11,255 - INFO - Learning rate: 0.000600
2025-06-08 21:49:24,040 - INFO - Epoch 15/30 (12.78s)
2025-06-08 21:49:24,040 - INFO - Train Loss: 0.3933, Train RMSE: 0.6272
2025-06-08 21:49:24,040 - INFO - Val Loss: 0.7956, Val RMSE: 0.8920
2025-06-08 21:49:24,041 - INFO - Learning rate: 0.000600
2025-06-08 21:49:36,846 - INFO - Epoch 16/30 (12.81s)
2025-06-08 21:49:36,847 - INFO - Train Loss: 0.3879, Train RMSE: 0.6228
2025-06-08 21:49:36,847 - INFO - Val Loss: 0.7971, Val RMSE: 0.8928
2025-06-08 21:49:36,847 - INFO - Learning rate: 0.000600
2025-06-08 21:49:36,848 - INFO - Early stopping at epoch 16
2025-06-08 21:49:36,848 - INFO - Baseline训练完成！总时间: 205.84s
2025-06-08 21:49:36,848 - INFO - Best validation loss: 0.7448
2025-06-08 21:49:36,848 - INFO - Best validation RMSE: 0.8630
2025-06-08 21:49:36,849 - INFO - 开始评估Baseline模型: Baseline Collaborative Filtering
2025-06-08 21:49:58,241 - INFO - Baseline模型保存至: ./data/model/model_checkpoint_baseline_with_scheduler.pt
2025-06-08 21:49:58,364 - ERROR - 训练Baseline模型时出错: Object of type device is not JSON serializable
2025-06-08 21:49:58,366 - ERROR - 详细错误信息: Traceback (most recent call last):
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 919, in main
    baseline_results = train_and_evaluate_baseline_model(
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 588, in train_and_evaluate_baseline_model
    json.dump(results, f, indent=2, ensure_ascii=False)
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 438, in _iterencode
    o = _default(o)
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type device is not JSON serializable

2025-06-08 21:49:58,369 - ERROR - 训练模型 用户时间感知模型 时出错: name 'train_and_evaluate_model' is not defined
2025-06-08 21:49:58,369 - ERROR - 详细错误信息: Traceback (most recent call last):
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 939, in main
    results = train_and_evaluate_model(
NameError: name 'train_and_evaluate_model' is not defined

2025-06-08 21:49:58,369 - ERROR - 训练模型 独立时间特征模型 时出错: name 'train_and_evaluate_model' is not defined
2025-06-08 21:49:58,370 - ERROR - 详细错误信息: Traceback (most recent call last):
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 939, in main
    results = train_and_evaluate_model(
NameError: name 'train_and_evaluate_model' is not defined

2025-06-08 21:49:58,370 - ERROR - 训练模型 用户电影时间感知模型 时出错: name 'train_and_evaluate_model' is not defined
2025-06-08 21:49:58,371 - ERROR - 详细错误信息: Traceback (most recent call last):
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 939, in main
    results = train_and_evaluate_model(
NameError: name 'train_and_evaluate_model' is not defined

2025-06-08 21:49:58,371 - INFO - 
============================================================
2025-06-08 21:49:58,372 - INFO - 开始训练和评估MMOE模型: 两阶段MMoE模型(带学习率调度)
2025-06-08 21:49:58,372 - INFO - ============================================================
2025-06-08 21:49:58,385 - INFO - MMOE模型参数: 总数=1,090,711, 可训练=1,090,711
2025-06-08 21:54:43,792 - INFO - 🚀 开始完整的模型比较流程...
2025-06-08 21:54:43,792 - INFO - 📁 工作目录: ./data/
2025-06-08 21:54:43,792 - INFO - ✅ 所有必要的数据文件都存在
2025-06-08 21:54:43,792 - INFO - 📂 确保目录存在: data\model
2025-06-08 21:54:43,793 - INFO - 📂 确保目录存在: data\results
2025-06-08 21:54:43,793 - INFO - 📂 确保目录存在: data\analysis_plots
2025-06-08 21:54:43,793 - INFO - 
================================================================================
2025-06-08 21:54:43,793 - INFO - 🔄 阶段1：训练所有模型
2025-06-08 21:54:43,793 - INFO - ================================================================================
2025-06-08 21:54:43,793 - INFO - 包括：Baseline、时间感知模型（UserTime、IndependentTime、UMTime）、MMOE
2025-06-08 21:54:43,794 - INFO - 开始训练所有模型...
2025-06-08 21:54:43,820 - INFO - 使用设备: cuda
2025-06-08 21:54:43,820 - INFO - 配置参数: {'DEVICE': device(type='cuda'), 'K_FACTORS': 100, 'TIME_FACTORS': 40, 'BATCH_SIZE': 256, 'NUM_EPOCHS': 30, 'LEARNING_RATE': 0.001, 'REG_STRENGTH': 0.001, 'NUM_EXPERTS': 4, 'NUM_EPOCHS_PER_STAGE': [30, 30, 30], 'LEARNING_RATES': [0.001, 0.001, 0.0005]}
2025-06-08 21:54:43,820 - INFO - 学习率调度器: ReduceLROnPlateau (factor=0.6, patience=5)
2025-06-08 21:54:43,821 - INFO - 加载现有数据分割...
2025-06-08 21:54:44,190 - INFO - Loaded existing split data from ./data/split_data
2025-06-08 21:54:44,190 - INFO - 数据分割 - 训练: 805443, 验证: 97383, 测试: 97383
2025-06-08 21:54:44,198 - INFO - 
============================================================
2025-06-08 21:54:44,198 - INFO - 开始训练和评估Baseline模型: Baseline Collaborative Filtering
2025-06-08 21:54:44,198 - INFO - ============================================================
2025-06-08 21:54:44,366 - INFO - Baseline模型参数: 总数=1,009,193, 可训练=1,009,193
2025-06-08 21:54:45,546 - INFO - 开始训练Baseline模型
2025-06-08 21:54:58,082 - INFO - Epoch 1/30 (12.54s)
2025-06-08 21:54:58,082 - INFO - Train Loss: 2.8617, Train RMSE: 1.6917
2025-06-08 21:54:58,082 - INFO - Val Loss: 0.8527, Val RMSE: 0.9234
2025-06-08 21:54:58,083 - INFO - Learning rate: 0.001000
2025-06-08 21:54:58,083 - INFO - New best validation loss: 0.8527
2025-06-08 21:55:11,423 - INFO - Epoch 2/30 (13.34s)
2025-06-08 21:55:11,423 - INFO - Train Loss: 0.8361, Train RMSE: 0.9144
2025-06-08 21:55:11,423 - INFO - Val Loss: 0.8075, Val RMSE: 0.8986
2025-06-08 21:55:11,424 - INFO - Learning rate: 0.001000
2025-06-08 21:55:11,424 - INFO - New best validation loss: 0.8075
2025-06-08 21:55:25,148 - INFO - Epoch 3/30 (13.72s)
2025-06-08 21:55:25,149 - INFO - Train Loss: 0.7774, Train RMSE: 0.8817
2025-06-08 21:55:25,149 - INFO - Val Loss: 0.7768, Val RMSE: 0.8814
2025-06-08 21:55:25,149 - INFO - Learning rate: 0.001000
2025-06-08 21:55:25,149 - INFO - New best validation loss: 0.7768
2025-06-08 21:55:38,434 - INFO - Epoch 4/30 (13.28s)
2025-06-08 21:55:38,434 - INFO - Train Loss: 0.7228, Train RMSE: 0.8502
2025-06-08 21:55:38,435 - INFO - Val Loss: 0.7579, Val RMSE: 0.8706
2025-06-08 21:55:38,435 - INFO - Learning rate: 0.001000
2025-06-08 21:55:38,435 - INFO - New best validation loss: 0.7579
2025-06-08 21:55:51,478 - INFO - Epoch 5/30 (13.04s)
2025-06-08 21:55:51,479 - INFO - Train Loss: 0.6657, Train RMSE: 0.8159
2025-06-08 21:55:51,479 - INFO - Val Loss: 0.7453, Val RMSE: 0.8633
2025-06-08 21:55:51,479 - INFO - Learning rate: 0.001000
2025-06-08 21:55:51,479 - INFO - New best validation loss: 0.7453
2025-06-08 21:56:04,652 - INFO - Epoch 6/30 (13.17s)
2025-06-08 21:56:04,653 - INFO - Train Loss: 0.6103, Train RMSE: 0.7812
2025-06-08 21:56:04,653 - INFO - Val Loss: 0.7458, Val RMSE: 0.8636
2025-06-08 21:56:04,653 - INFO - Learning rate: 0.001000
2025-06-08 21:56:17,399 - INFO - Epoch 7/30 (12.74s)
2025-06-08 21:56:17,399 - INFO - Train Loss: 0.5613, Train RMSE: 0.7492
2025-06-08 21:56:17,400 - INFO - Val Loss: 0.7504, Val RMSE: 0.8663
2025-06-08 21:56:17,400 - INFO - Learning rate: 0.001000
2025-06-08 21:56:30,190 - INFO - Epoch 8/30 (12.79s)
2025-06-08 21:56:30,191 - INFO - Train Loss: 0.5222, Train RMSE: 0.7226
2025-06-08 21:56:30,192 - INFO - Val Loss: 0.7578, Val RMSE: 0.8705
2025-06-08 21:56:30,192 - INFO - Learning rate: 0.001000
2025-06-08 21:56:43,126 - INFO - Epoch 9/30 (12.93s)
2025-06-08 21:56:43,127 - INFO - Train Loss: 0.4914, Train RMSE: 0.7010
2025-06-08 21:56:43,127 - INFO - Val Loss: 0.7667, Val RMSE: 0.8756
2025-06-08 21:56:43,127 - INFO - Learning rate: 0.001000
2025-06-08 21:56:56,191 - INFO - Epoch 10/30 (13.06s)
2025-06-08 21:56:56,192 - INFO - Train Loss: 0.4678, Train RMSE: 0.6840
2025-06-08 21:56:56,192 - INFO - Val Loss: 0.7760, Val RMSE: 0.8809
2025-06-08 21:56:56,192 - INFO - Learning rate: 0.001000
2025-06-08 21:57:09,438 - INFO - Epoch 11/30 (13.25s)
2025-06-08 21:57:09,439 - INFO - Train Loss: 0.4508, Train RMSE: 0.6714
2025-06-08 21:57:09,439 - INFO - Val Loss: 0.7823, Val RMSE: 0.8845
2025-06-08 21:57:09,439 - INFO - Learning rate: 0.001000
2025-06-08 21:57:24,007 - INFO - Epoch 12/30 (14.57s)
2025-06-08 21:57:24,007 - INFO - Train Loss: 0.4189, Train RMSE: 0.6473
2025-06-08 21:57:24,007 - INFO - Val Loss: 0.7823, Val RMSE: 0.8845
2025-06-08 21:57:24,007 - INFO - Learning rate: 0.000600
2025-06-08 21:57:38,060 - INFO - Epoch 13/30 (14.05s)
2025-06-08 21:57:38,060 - INFO - Train Loss: 0.4103, Train RMSE: 0.6405
2025-06-08 21:57:38,062 - INFO - Val Loss: 0.7849, Val RMSE: 0.8859
2025-06-08 21:57:38,062 - INFO - Learning rate: 0.000600
2025-06-08 21:57:51,337 - INFO - Epoch 14/30 (13.28s)
2025-06-08 21:57:51,337 - INFO - Train Loss: 0.4016, Train RMSE: 0.6337
2025-06-08 21:57:51,337 - INFO - Val Loss: 0.7878, Val RMSE: 0.8876
2025-06-08 21:57:51,337 - INFO - Learning rate: 0.000600
2025-06-08 21:58:04,551 - INFO - Epoch 15/30 (13.21s)
2025-06-08 21:58:04,551 - INFO - Train Loss: 0.3951, Train RMSE: 0.6286
2025-06-08 21:58:04,552 - INFO - Val Loss: 0.7900, Val RMSE: 0.8888
2025-06-08 21:58:04,552 - INFO - Learning rate: 0.000600
2025-06-08 21:58:04,552 - INFO - Early stopping at epoch 15
2025-06-08 21:58:04,558 - INFO - Baseline训练完成！总时间: 199.01s
2025-06-08 21:58:04,558 - INFO - Best validation loss: 0.7453
2025-06-08 21:58:04,558 - INFO - Best validation RMSE: 0.8633
2025-06-08 21:58:04,559 - INFO - 开始评估Baseline模型: Baseline Collaborative Filtering
2025-06-08 21:58:26,391 - INFO - Baseline模型保存至: ./data/model/model_checkpoint_baseline_with_scheduler.pt
2025-06-08 21:58:26,514 - ERROR - 训练Baseline模型时出错: Object of type device is not JSON serializable
2025-06-08 21:58:26,516 - ERROR - 详细错误信息: Traceback (most recent call last):
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 1110, in main
    baseline_results = train_and_evaluate_baseline_model(
  File "g:\Personal\1C401\CS182_proj\torch_ver\train_comparison.py", line 779, in train_and_evaluate_baseline_model
    json.dump(results, f, indent=2, ensure_ascii=False)
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\__init__.py", line 179, in dump
    for chunk in iterable:
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 438, in _iterencode
    o = _default(o)
  File "C:\Users\ly_xm\anaconda3\envs\182proj\lib\json\encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type device is not JSON serializable

2025-06-08 21:58:26,518 - INFO - 
============================================================
2025-06-08 21:58:26,518 - INFO - 开始训练和评估模型: 用户时间感知模型
2025-06-08 21:58:26,519 - INFO - ============================================================
2025-06-08 21:58:26,532 - INFO - 用户时间感知模型参数: 总数=1,033,219, 可训练=1,033,219
2025-06-08 21:58:26,533 - INFO - 开始训练模型: IndependentTime
2025-06-08 21:58:47,928 - INFO - Epoch 1/30 (21.40s)
2025-06-08 21:58:47,928 - INFO - Train Loss: 1.2127, Train RMSE: 1.1012
2025-06-08 21:58:47,928 - INFO - Val Loss: 0.8319, Val RMSE: 0.9121
2025-06-08 21:58:47,928 - INFO - Learning rate: 0.001000
2025-06-08 21:58:47,929 - INFO - New best validation loss: 0.8319
2025-06-08 21:59:08,846 - INFO - Epoch 2/30 (20.92s)
2025-06-08 21:59:08,846 - INFO - Train Loss: 0.7777, Train RMSE: 0.8819
2025-06-08 21:59:08,846 - INFO - Val Loss: 0.7720, Val RMSE: 0.8786
2025-06-08 21:59:08,847 - INFO - Learning rate: 0.001000
2025-06-08 21:59:08,847 - INFO - New best validation loss: 0.7720
2025-06-08 21:59:30,334 - INFO - Epoch 3/30 (21.49s)
2025-06-08 21:59:30,335 - INFO - Train Loss: 0.7205, Train RMSE: 0.8488
2025-06-08 21:59:30,335 - INFO - Val Loss: 0.7491, Val RMSE: 0.8655
2025-06-08 21:59:30,335 - INFO - Learning rate: 0.001000
2025-06-08 21:59:30,336 - INFO - New best validation loss: 0.7491
2025-06-08 21:59:54,306 - INFO - Epoch 4/30 (23.97s)
2025-06-08 21:59:54,307 - INFO - Train Loss: 0.6789, Train RMSE: 0.8240
2025-06-08 21:59:54,307 - INFO - Val Loss: 0.7354, Val RMSE: 0.8575
2025-06-08 21:59:54,307 - INFO - Learning rate: 0.001000
2025-06-08 21:59:54,308 - INFO - New best validation loss: 0.7354
2025-06-08 22:00:20,249 - INFO - Epoch 5/30 (25.94s)
2025-06-08 22:00:20,250 - INFO - Train Loss: 0.6440, Train RMSE: 0.8025
2025-06-08 22:00:20,250 - INFO - Val Loss: 0.7287, Val RMSE: 0.8537
2025-06-08 22:00:20,250 - INFO - Learning rate: 0.001000
2025-06-08 22:00:20,250 - INFO - New best validation loss: 0.7287
2025-06-08 22:00:41,467 - INFO - Epoch 6/30 (21.22s)
2025-06-08 22:00:41,468 - INFO - Train Loss: 0.6155, Train RMSE: 0.7845
2025-06-08 22:00:41,468 - INFO - Val Loss: 0.7277, Val RMSE: 0.8531
2025-06-08 22:00:41,469 - INFO - Learning rate: 0.001000
2025-06-08 22:00:41,469 - INFO - New best validation loss: 0.7277
2025-06-08 22:01:02,969 - INFO - Epoch 7/30 (21.50s)
2025-06-08 22:01:02,969 - INFO - Train Loss: 0.5914, Train RMSE: 0.7690
2025-06-08 22:01:02,970 - INFO - Val Loss: 0.7270, Val RMSE: 0.8526
2025-06-08 22:01:02,970 - INFO - Learning rate: 0.001000
2025-06-08 22:01:02,970 - INFO - New best validation loss: 0.7270
2025-06-08 22:01:24,079 - INFO - Epoch 8/30 (21.11s)
2025-06-08 22:01:24,079 - INFO - Train Loss: 0.5720, Train RMSE: 0.7563
2025-06-08 22:01:24,080 - INFO - Val Loss: 0.7281, Val RMSE: 0.8533
2025-06-08 22:01:24,080 - INFO - Learning rate: 0.001000
2025-06-08 22:01:45,597 - INFO - Epoch 9/30 (21.52s)
2025-06-08 22:01:45,598 - INFO - Train Loss: 0.5573, Train RMSE: 0.7465
2025-06-08 22:01:45,598 - INFO - Val Loss: 0.7296, Val RMSE: 0.8542
2025-06-08 22:01:45,598 - INFO - Learning rate: 0.001000
2025-06-08 22:02:07,372 - INFO - Epoch 10/30 (21.77s)
2025-06-08 22:02:07,373 - INFO - Train Loss: 0.5453, Train RMSE: 0.7384
2025-06-08 22:02:07,373 - INFO - Val Loss: 0.7319, Val RMSE: 0.8555
2025-06-08 22:02:07,373 - INFO - Learning rate: 0.001000
2025-06-08 22:02:29,466 - INFO - Epoch 11/30 (22.09s)
2025-06-08 22:02:29,466 - INFO - Train Loss: 0.5360, Train RMSE: 0.7321
2025-06-08 22:02:29,466 - INFO - Val Loss: 0.7344, Val RMSE: 0.8570
2025-06-08 22:02:29,467 - INFO - Learning rate: 0.001000
2025-06-08 22:02:51,932 - INFO - Epoch 12/30 (22.46s)
2025-06-08 22:02:51,933 - INFO - Train Loss: 0.5276, Train RMSE: 0.7264
2025-06-08 22:02:51,933 - INFO - Val Loss: 0.7364, Val RMSE: 0.8581
2025-06-08 22:02:51,933 - INFO - Learning rate: 0.001000
2025-06-08 22:03:04,407 - INFO - 🚀 开始完整的模型比较流程...
2025-06-08 22:03:04,407 - INFO - 📁 工作目录: ./data/
2025-06-08 22:03:04,408 - INFO - ✅ 所有必要的数据文件都存在
2025-06-08 22:03:04,408 - INFO - 📂 确保目录存在: data\model
2025-06-08 22:03:04,409 - INFO - 📂 确保目录存在: data\results
2025-06-08 22:03:04,409 - INFO - 📂 确保目录存在: data\analysis_plots
2025-06-08 22:03:04,409 - INFO - 
================================================================================
2025-06-08 22:03:04,409 - INFO - 🔄 阶段1：训练所有模型
2025-06-08 22:03:04,410 - INFO - ================================================================================
2025-06-08 22:03:04,410 - INFO - 包括：Baseline、时间感知模型（UserTime、IndependentTime、UMTime）、MMOE
2025-06-08 22:03:04,410 - INFO - 开始训练所有模型...
2025-06-08 22:03:04,445 - INFO - 使用设备: cuda
2025-06-08 22:03:04,446 - INFO - 配置参数: {'DEVICE': device(type='cuda'), 'K_FACTORS': 100, 'TIME_FACTORS': 40, 'BATCH_SIZE': 256, 'NUM_EPOCHS': 30, 'LEARNING_RATE': 0.001, 'REG_STRENGTH': 0.001, 'NUM_EXPERTS': 4, 'NUM_EPOCHS_PER_STAGE': [30, 30, 30], 'LEARNING_RATES': [0.001, 0.001, 0.0005]}
2025-06-08 22:03:04,446 - INFO - 学习率调度器: ReduceLROnPlateau (factor=0.6, patience=5)
2025-06-08 22:03:04,447 - INFO - 加载现有数据分割...
2025-06-08 22:03:04,879 - INFO - Loaded existing split data from ./data/split_data
2025-06-08 22:03:04,880 - INFO - 数据分割 - 训练: 805443, 验证: 97383, 测试: 97383
2025-06-08 22:03:04,887 - INFO - 
============================================================
2025-06-08 22:03:04,888 - INFO - 开始训练和评估Baseline模型: Baseline Collaborative Filtering
2025-06-08 22:03:04,888 - INFO - ============================================================
2025-06-08 22:03:05,027 - INFO - Baseline模型参数: 总数=1,009,193, 可训练=1,009,193
2025-06-08 22:03:06,653 - INFO - 开始训练Baseline模型
2025-06-08 22:03:19,682 - INFO - Epoch 1/30 (13.03s)
2025-06-08 22:03:19,682 - INFO - Train Loss: 2.8625, Train RMSE: 1.6919
2025-06-08 22:03:19,683 - INFO - Val Loss: 0.8534, Val RMSE: 0.9238
2025-06-08 22:03:19,683 - INFO - Learning rate: 0.001000
2025-06-08 22:03:19,683 - INFO - New best validation loss: 0.8534
2025-06-08 22:03:32,801 - INFO - Epoch 2/30 (13.12s)
2025-06-08 22:03:32,801 - INFO - Train Loss: 0.8318, Train RMSE: 0.9120
2025-06-08 22:03:32,801 - INFO - Val Loss: 0.8028, Val RMSE: 0.8960
2025-06-08 22:03:32,802 - INFO - Learning rate: 0.001000
2025-06-08 22:03:32,802 - INFO - New best validation loss: 0.8028
2025-06-08 22:03:46,482 - INFO - Epoch 3/30 (13.68s)
2025-06-08 22:03:46,484 - INFO - Train Loss: 0.7722, Train RMSE: 0.8788
2025-06-08 22:03:46,484 - INFO - Val Loss: 0.7748, Val RMSE: 0.8803
2025-06-08 22:03:46,484 - INFO - Learning rate: 0.001000
2025-06-08 22:03:46,484 - INFO - New best validation loss: 0.7748
2025-06-08 22:03:59,846 - INFO - Epoch 4/30 (13.36s)
2025-06-08 22:03:59,846 - INFO - Train Loss: 0.7185, Train RMSE: 0.8476
2025-06-08 22:03:59,846 - INFO - Val Loss: 0.7575, Val RMSE: 0.8703
2025-06-08 22:03:59,847 - INFO - Learning rate: 0.001000
2025-06-08 22:03:59,847 - INFO - New best validation loss: 0.7575
2025-06-08 22:04:12,804 - INFO - Epoch 5/30 (12.96s)
2025-06-08 22:04:12,804 - INFO - Train Loss: 0.6633, Train RMSE: 0.8144
2025-06-08 22:04:12,804 - INFO - Val Loss: 0.7471, Val RMSE: 0.8644
2025-06-08 22:04:12,804 - INFO - Learning rate: 0.001000
2025-06-08 22:04:12,805 - INFO - New best validation loss: 0.7471
2025-06-08 22:04:27,081 - INFO - Epoch 6/30 (14.28s)
2025-06-08 22:04:27,082 - INFO - Train Loss: 0.6096, Train RMSE: 0.7807
2025-06-08 22:04:27,082 - INFO - Val Loss: 0.7472, Val RMSE: 0.8644
2025-06-08 22:04:27,083 - INFO - Learning rate: 0.001000
2025-06-08 22:04:41,520 - INFO - Epoch 7/30 (14.44s)
2025-06-08 22:04:41,521 - INFO - Train Loss: 0.5599, Train RMSE: 0.7483
2025-06-08 22:04:41,521 - INFO - Val Loss: 0.7535, Val RMSE: 0.8680
2025-06-08 22:04:41,521 - INFO - Learning rate: 0.001000
2025-06-08 22:04:54,605 - INFO - Epoch 8/30 (13.08s)
2025-06-08 22:04:54,605 - INFO - Train Loss: 0.5206, Train RMSE: 0.7215
2025-06-08 22:04:54,605 - INFO - Val Loss: 0.7616, Val RMSE: 0.8727
2025-06-08 22:04:54,606 - INFO - Learning rate: 0.001000
2025-06-08 22:05:08,671 - INFO - Epoch 9/30 (14.06s)
2025-06-08 22:05:08,671 - INFO - Train Loss: 0.4905, Train RMSE: 0.7004
2025-06-08 22:05:08,671 - INFO - Val Loss: 0.7705, Val RMSE: 0.8778
2025-06-08 22:05:08,672 - INFO - Learning rate: 0.001000
2025-06-08 22:05:22,615 - INFO - Epoch 10/30 (13.94s)
2025-06-08 22:05:22,615 - INFO - Train Loss: 0.4684, Train RMSE: 0.6844
2025-06-08 22:05:22,615 - INFO - Val Loss: 0.7798, Val RMSE: 0.8830
2025-06-08 22:05:22,616 - INFO - Learning rate: 0.001000
2025-06-08 22:05:36,373 - INFO - Epoch 11/30 (13.76s)
2025-06-08 22:05:36,373 - INFO - Train Loss: 0.4510, Train RMSE: 0.6716
2025-06-08 22:05:36,374 - INFO - Val Loss: 0.7867, Val RMSE: 0.8870
2025-06-08 22:05:36,374 - INFO - Learning rate: 0.001000
2025-06-08 22:05:51,570 - INFO - Epoch 12/30 (15.20s)
2025-06-08 22:05:51,571 - INFO - Train Loss: 0.4195, Train RMSE: 0.6477
2025-06-08 22:05:51,571 - INFO - Val Loss: 0.7866, Val RMSE: 0.8869
2025-06-08 22:05:51,571 - INFO - Learning rate: 0.000600
2025-06-08 22:06:05,326 - INFO - Epoch 13/30 (13.75s)
2025-06-08 22:06:05,327 - INFO - Train Loss: 0.4091, Train RMSE: 0.6396
2025-06-08 22:06:05,327 - INFO - Val Loss: 0.7901, Val RMSE: 0.8889
2025-06-08 22:06:05,327 - INFO - Learning rate: 0.000600
2025-06-08 22:06:18,853 - INFO - Epoch 14/30 (13.53s)
2025-06-08 22:06:18,854 - INFO - Train Loss: 0.4020, Train RMSE: 0.6341
2025-06-08 22:06:18,854 - INFO - Val Loss: 0.7918, Val RMSE: 0.8898
2025-06-08 22:06:18,854 - INFO - Learning rate: 0.000600
2025-06-08 22:06:32,454 - INFO - Epoch 15/30 (13.60s)
2025-06-08 22:06:32,454 - INFO - Train Loss: 0.3960, Train RMSE: 0.6293
2025-06-08 22:06:32,454 - INFO - Val Loss: 0.7938, Val RMSE: 0.8909
2025-06-08 22:06:32,455 - INFO - Learning rate: 0.000600
2025-06-08 22:06:32,455 - INFO - Early stopping at epoch 15
2025-06-08 22:06:32,456 - INFO - Baseline训练完成！总时间: 205.80s
2025-06-08 22:06:32,456 - INFO - Best validation loss: 0.7471
2025-06-08 22:06:32,457 - INFO - Best validation RMSE: 0.8644
2025-06-08 22:06:32,457 - INFO - 开始评估Baseline模型: Baseline Collaborative Filtering
2025-06-08 22:06:57,775 - INFO - Baseline模型保存至: ./data/model/model_checkpoint_baseline_with_scheduler.pt
2025-06-08 22:06:57,925 - INFO - Baseline模型 Baseline Collaborative Filtering 训练和评估完成!
2025-06-08 22:06:57,925 - INFO - 测试 RMSE: 0.8898
2025-06-08 22:06:57,926 - INFO - 测试 MAE: 0.6977
2025-06-08 22:06:57,926 - INFO - 
============================================================
2025-06-08 22:06:57,926 - INFO - 开始训练和评估模型: 用户时间感知模型
2025-06-08 22:06:57,927 - INFO - ============================================================
2025-06-08 22:06:57,944 - INFO - 用户时间感知模型参数: 总数=1,033,219, 可训练=1,033,219
2025-06-08 22:06:57,945 - INFO - 开始训练模型: IndependentTime
2025-06-08 22:07:22,804 - INFO - Epoch 1/30 (24.86s)
2025-06-08 22:07:22,805 - INFO - Train Loss: 1.2305, Train RMSE: 1.1093
2025-06-08 22:07:22,805 - INFO - Val Loss: 0.8313, Val RMSE: 0.9118
2025-06-08 22:07:22,805 - INFO - Learning rate: 0.001000
2025-06-08 22:07:22,805 - INFO - New best validation loss: 0.8313
2025-06-08 22:07:45,675 - INFO - Epoch 2/30 (22.87s)
2025-06-08 22:07:45,675 - INFO - Train Loss: 0.7778, Train RMSE: 0.8819
2025-06-08 22:07:45,675 - INFO - Val Loss: 0.7722, Val RMSE: 0.8787
2025-06-08 22:07:45,676 - INFO - Learning rate: 0.001000
2025-06-08 22:07:45,676 - INFO - New best validation loss: 0.7722
2025-06-08 22:08:07,015 - INFO - Epoch 3/30 (21.34s)
2025-06-08 22:08:07,016 - INFO - Train Loss: 0.7194, Train RMSE: 0.8482
2025-06-08 22:08:07,016 - INFO - Val Loss: 0.7473, Val RMSE: 0.8645
2025-06-08 22:08:07,016 - INFO - Learning rate: 0.001000
2025-06-08 22:08:07,018 - INFO - New best validation loss: 0.7473
2025-06-08 22:08:27,377 - INFO - Epoch 4/30 (20.36s)
2025-06-08 22:08:27,377 - INFO - Train Loss: 0.6768, Train RMSE: 0.8227
2025-06-08 22:08:27,378 - INFO - Val Loss: 0.7350, Val RMSE: 0.8573
2025-06-08 22:08:27,378 - INFO - Learning rate: 0.001000
2025-06-08 22:08:27,378 - INFO - New best validation loss: 0.7350
2025-06-08 22:08:48,099 - INFO - Epoch 5/30 (20.72s)
2025-06-08 22:08:48,099 - INFO - Train Loss: 0.6417, Train RMSE: 0.8011
2025-06-08 22:08:48,100 - INFO - Val Loss: 0.7286, Val RMSE: 0.8536
2025-06-08 22:08:48,100 - INFO - Learning rate: 0.001000
2025-06-08 22:08:48,100 - INFO - New best validation loss: 0.7286
2025-06-08 22:09:09,270 - INFO - Epoch 6/30 (21.17s)
2025-06-08 22:09:09,270 - INFO - Train Loss: 0.6136, Train RMSE: 0.7833
2025-06-08 22:09:09,271 - INFO - Val Loss: 0.7261, Val RMSE: 0.8521
2025-06-08 22:09:09,271 - INFO - Learning rate: 0.001000
2025-06-08 22:09:09,271 - INFO - New best validation loss: 0.7261
2025-06-08 22:09:30,560 - INFO - Epoch 7/30 (21.29s)
2025-06-08 22:09:30,561 - INFO - Train Loss: 0.5905, Train RMSE: 0.7684
2025-06-08 22:09:30,561 - INFO - Val Loss: 0.7268, Val RMSE: 0.8525
2025-06-08 22:09:30,561 - INFO - Learning rate: 0.001000
2025-06-08 22:09:51,873 - INFO - Epoch 8/30 (21.31s)
2025-06-08 22:09:51,874 - INFO - Train Loss: 0.5719, Train RMSE: 0.7563
2025-06-08 22:09:51,874 - INFO - Val Loss: 0.7273, Val RMSE: 0.8528
2025-06-08 22:09:51,874 - INFO - Learning rate: 0.001000
2025-06-08 22:10:12,388 - INFO - Epoch 9/30 (20.51s)
2025-06-08 22:10:12,388 - INFO - Train Loss: 0.5565, Train RMSE: 0.7460
2025-06-08 22:10:12,389 - INFO - Val Loss: 0.7288, Val RMSE: 0.8537
2025-06-08 22:10:12,389 - INFO - Learning rate: 0.001000
2025-06-08 22:10:33,512 - INFO - Epoch 10/30 (21.12s)
2025-06-08 22:10:33,512 - INFO - Train Loss: 0.5445, Train RMSE: 0.7379
2025-06-08 22:10:33,513 - INFO - Val Loss: 0.7313, Val RMSE: 0.8552
2025-06-08 22:10:33,513 - INFO - Learning rate: 0.001000
2025-06-08 22:10:56,233 - INFO - Epoch 11/30 (22.72s)
2025-06-08 22:10:56,233 - INFO - Train Loss: 0.5353, Train RMSE: 0.7317
2025-06-08 22:10:56,233 - INFO - Val Loss: 0.7328, Val RMSE: 0.8561
2025-06-08 22:10:56,234 - INFO - Learning rate: 0.001000
2025-06-08 22:11:17,528 - INFO - Epoch 12/30 (21.29s)
2025-06-08 22:11:17,529 - INFO - Train Loss: 0.5282, Train RMSE: 0.7268
2025-06-08 22:11:17,529 - INFO - Val Loss: 0.7343, Val RMSE: 0.8569
2025-06-08 22:11:17,529 - INFO - Learning rate: 0.001000
2025-06-08 22:11:37,992 - INFO - Epoch 13/30 (20.46s)
2025-06-08 22:11:37,992 - INFO - Train Loss: 0.5031, Train RMSE: 0.7093
2025-06-08 22:11:37,992 - INFO - Val Loss: 0.7344, Val RMSE: 0.8570
2025-06-08 22:11:37,992 - INFO - Learning rate: 0.000600
2025-06-08 22:11:59,342 - INFO - Epoch 14/30 (21.35s)
2025-06-08 22:11:59,342 - INFO - Train Loss: 0.4964, Train RMSE: 0.7045
2025-06-08 22:11:59,342 - INFO - Val Loss: 0.7335, Val RMSE: 0.8565
2025-06-08 22:11:59,342 - INFO - Learning rate: 0.000600
2025-06-08 22:12:21,265 - INFO - Epoch 15/30 (21.92s)
2025-06-08 22:12:21,265 - INFO - Train Loss: 0.4927, Train RMSE: 0.7019
2025-06-08 22:12:21,265 - INFO - Val Loss: 0.7339, Val RMSE: 0.8567
2025-06-08 22:12:21,265 - INFO - Learning rate: 0.000600
2025-06-08 22:12:41,854 - INFO - Epoch 16/30 (20.59s)
2025-06-08 22:12:41,855 - INFO - Train Loss: 0.4897, Train RMSE: 0.6998
2025-06-08 22:12:41,855 - INFO - Val Loss: 0.7344, Val RMSE: 0.8569
2025-06-08 22:12:41,855 - INFO - Learning rate: 0.000600
2025-06-08 22:12:41,855 - INFO - Early stopping at epoch 16
2025-06-08 22:12:41,855 - INFO - 训练完成！总时间: 343.91s
2025-06-08 22:12:41,857 - INFO - Best validation loss: 0.7261
2025-06-08 22:12:41,857 - INFO - Best validation RMSE: 0.8521
2025-06-08 22:12:41,857 - INFO - 开始评估模型: 用户时间感知模型
2025-06-08 22:13:39,553 - INFO - 模型保存至: ./data/model/model_checkpoint_IndependentTime_with_scheduler.pt
2025-06-08 22:13:39,678 - INFO - 模型 用户时间感知模型 训练和评估完成!
2025-06-08 22:13:39,678 - INFO - 测试 RMSE: 0.8556
2025-06-08 22:13:39,678 - INFO - 测试 MAE: 0.6713
2025-06-08 22:13:39,678 - INFO - 
============================================================
2025-06-08 22:13:39,679 - INFO - 开始训练和评估模型: 独立时间特征模型
2025-06-08 22:13:39,679 - INFO - ============================================================
2025-06-08 22:13:39,688 - INFO - 独立时间特征模型参数: 总数=1,015,079, 可训练=1,015,079
2025-06-08 22:13:39,688 - INFO - 开始训练模型: UMTime
2025-06-08 22:13:59,083 - INFO - Epoch 1/30 (19.39s)
2025-06-08 22:13:59,083 - INFO - Train Loss: 1.2561, Train RMSE: 1.1208
2025-06-08 22:13:59,083 - INFO - Val Loss: 0.8822, Val RMSE: 0.9393
2025-06-08 22:13:59,083 - INFO - Learning rate: 0.001000
2025-06-08 22:13:59,083 - INFO - New best validation loss: 0.8822
2025-06-08 22:14:18,725 - INFO - Epoch 2/30 (19.64s)
2025-06-08 22:14:18,725 - INFO - Train Loss: 0.8238, Train RMSE: 0.9077
2025-06-08 22:14:18,725 - INFO - Val Loss: 0.8030, Val RMSE: 0.8961
2025-06-08 22:14:18,725 - INFO - Learning rate: 0.001000
2025-06-08 22:14:18,727 - INFO - New best validation loss: 0.8030
2025-06-08 22:14:38,118 - INFO - Epoch 3/30 (19.39s)
2025-06-08 22:14:38,118 - INFO - Train Loss: 0.7701, Train RMSE: 0.8776
2025-06-08 22:14:38,119 - INFO - Val Loss: 0.7778, Val RMSE: 0.8819
2025-06-08 22:14:38,119 - INFO - Learning rate: 0.001000
2025-06-08 22:14:38,119 - INFO - New best validation loss: 0.7778
2025-06-08 22:14:57,572 - INFO - Epoch 4/30 (19.45s)
2025-06-08 22:14:57,572 - INFO - Train Loss: 0.7421, Train RMSE: 0.8615
2025-06-08 22:14:57,572 - INFO - Val Loss: 0.7629, Val RMSE: 0.8734
2025-06-08 22:14:57,573 - INFO - Learning rate: 0.001000
2025-06-08 22:14:57,573 - INFO - New best validation loss: 0.7629
2025-06-08 22:15:17,302 - INFO - Epoch 5/30 (19.73s)
2025-06-08 22:15:17,302 - INFO - Train Loss: 0.7227, Train RMSE: 0.8501
2025-06-08 22:15:17,303 - INFO - Val Loss: 0.7536, Val RMSE: 0.8681
2025-06-08 22:15:17,303 - INFO - Learning rate: 0.001000
2025-06-08 22:15:17,303 - INFO - New best validation loss: 0.7536
2025-06-08 22:15:37,642 - INFO - Epoch 6/30 (20.34s)
2025-06-08 22:15:37,643 - INFO - Train Loss: 0.7083, Train RMSE: 0.8416
2025-06-08 22:15:37,643 - INFO - Val Loss: 0.7469, Val RMSE: 0.8642
2025-06-08 22:15:37,644 - INFO - Learning rate: 0.001000
2025-06-08 22:15:37,644 - INFO - New best validation loss: 0.7469
2025-06-08 22:15:57,183 - INFO - Epoch 7/30 (19.54s)
2025-06-08 22:15:57,184 - INFO - Train Loss: 0.6975, Train RMSE: 0.8352
2025-06-08 22:15:57,184 - INFO - Val Loss: 0.7437, Val RMSE: 0.8624
2025-06-08 22:15:57,184 - INFO - Learning rate: 0.001000
2025-06-08 22:15:57,185 - INFO - New best validation loss: 0.7437
2025-06-08 22:16:16,666 - INFO - Epoch 8/30 (19.48s)
2025-06-08 22:16:16,667 - INFO - Train Loss: 0.6904, Train RMSE: 0.8309
2025-06-08 22:16:16,667 - INFO - Val Loss: 0.7407, Val RMSE: 0.8606
2025-06-08 22:16:16,667 - INFO - Learning rate: 0.001000
2025-06-08 22:16:16,668 - INFO - New best validation loss: 0.7407
2025-06-08 22:16:36,233 - INFO - Epoch 9/30 (19.56s)
2025-06-08 22:16:36,233 - INFO - Train Loss: 0.6835, Train RMSE: 0.8268
2025-06-08 22:16:36,234 - INFO - Val Loss: 0.7388, Val RMSE: 0.8595
2025-06-08 22:16:36,234 - INFO - Learning rate: 0.001000
2025-06-08 22:16:36,234 - INFO - New best validation loss: 0.7388
2025-06-08 22:16:55,578 - INFO - Epoch 10/30 (19.34s)
2025-06-08 22:16:55,579 - INFO - Train Loss: 0.6771, Train RMSE: 0.8228
2025-06-08 22:16:55,579 - INFO - Val Loss: 0.7370, Val RMSE: 0.8585
2025-06-08 22:16:55,579 - INFO - Learning rate: 0.001000
2025-06-08 22:16:55,579 - INFO - New best validation loss: 0.7370
2025-06-08 22:17:15,313 - INFO - Epoch 11/30 (19.73s)
2025-06-08 22:17:15,314 - INFO - Train Loss: 0.6733, Train RMSE: 0.8205
2025-06-08 22:17:15,314 - INFO - Val Loss: 0.7359, Val RMSE: 0.8578
2025-06-08 22:17:15,314 - INFO - Learning rate: 0.001000
2025-06-08 22:17:15,315 - INFO - New best validation loss: 0.7359
2025-06-08 22:17:35,054 - INFO - Epoch 12/30 (19.74s)
2025-06-08 22:17:35,054 - INFO - Train Loss: 0.6704, Train RMSE: 0.8188
2025-06-08 22:17:35,054 - INFO - Val Loss: 0.7353, Val RMSE: 0.8575
2025-06-08 22:17:35,055 - INFO - Learning rate: 0.001000
2025-06-08 22:17:35,055 - INFO - New best validation loss: 0.7353
